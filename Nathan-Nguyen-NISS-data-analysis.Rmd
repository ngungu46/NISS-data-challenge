---
output: 
  pdf_document:
    citation_package: natbib
    keep_tex: true
    fig_caption: true
    latex_engine: pdflatex
    template: ~/R/NISS-data-challenge/temp.tex
title: "NISS Data Challenge - Education, Employment, and Earnings"
author:
- name: Nathan Nguyen
  affiliation: Duke University
abstract: "This document provides an introduction to R Markdown, argues for its benefits, and presents a sample manuscript template intended for an academic audience. I include basic syntax to R Markdown and a minimal working example of how the analysis itself can be conducted within R with the `knitr` package."
keywords: "pandoc, r markdown, knitr"
date: "`r format(Sys.time(), '%B %d, %Y')`"
geometry: margin=1in
fontfamily: mathpazo
fontsize: 11pt
# spacing: double
bibliography: ~/Dropbox/master.bib
biblio-style: apsr
endnote: no
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load-package, message = FALSE, warning = FALSE, echo = FALSE}
library(tidyverse)
library(usethis)
library(patchwork)
library(viridis)
library(ggvis)
library(stringr)
```

```{r load-data, message = FALSE, warning = FALSE, echo = FALSE}
data <- read.csv("data/HSLSEEESAID.csv")
```

# Introduction

```{r text-setup}
library(showtext)
font_add_google("Poppins", "Poppins")
font_add_google("Lora", "Lora")
showtext_auto()
```

```{r rearrange-vectors}
order2 <- c("Don't know", "More than a bachelor's degree", "Bachelor's degree", 
           "Associate's degree", "Some college", 
           "High school diploma, equivalent, or less"
           )

order <- c("Don't Know", "Other", "Trades and technical", "STEM", "Service",
            "Military and protective services", "Healthcare", "Education", 
            "Business and Management", "Arts and entertainment")
```


```{r visualization}
theme_set(theme_light(base_size = 9, base_family = "Lora"))

ggplot(data, aes(factor(S4JobIndustry, levels = order), fill = X4LOCALE))+
  geom_bar(position = "fill", width = .5)+
  coord_flip()+
  scale_fill_viridis_d()+
  theme_linedraw()+
  labs(y = "Percentage",
       x = "Expected Job",
       fill = "Location")+
  theme(
    text = element_text(family = "Lora", size = 12),
    legend.position = "bottom",
    axis.ticks.x = element_blank()
  )+
  scale_y_continuous(labels = function(x) paste0(x*100, "%"), expand = c(0,0))
```
```{r eval = F}
ggplot(data, aes(S4EdExpected, X4X2SES, color = S4EdExpected))+
  geom_boxplot()+
  stat_summary(fun = mean, geom = "point", size = 3)+
  theme(
    text = element_text(family = "Lora", size = 12),
    legend.position = "none",
    panel.grid = element_blank()
  )+
  coord_flip()+
  scale_color_viridis_d()
```




